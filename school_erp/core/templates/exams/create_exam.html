{% extends "base/layout.html" %}
{% block content %}

<h1 class="text-xl font-semibold mb-6">Create New Exam</h1>

<form method="post" id="createExamForm" class="bg-white p-6 rounded shadow max-w-xl">
    {% csrf_token %}

    <label class="block mb-2">Exam Name</label>
    <input type="text" id="exam_name" class="form-control mb-4" required>

    <label class="block mb-2">Start Date</label>
    <input type="date" id="start_date" class="form-control mb-4" required>

    <label class="block mb-2">End Date</label>
    <input type="date" id="end_date" class="form-control mb-6" required>

    <button class="bg-blue-600 text-white px-6 py-2 rounded">
        Create Exam
    </button>
</form>

<script>
document.getElementById("createExamForm").onsubmit = async (e) => {
    e.preventDefault();

    const res = await fetch(
        "https://erp.backend.smartbus360.com/exams",
        {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": "Bearer {{ request.session.auth.access_token }}"
            },
            body: JSON.stringify({
                name: exam_name.value,
                start_date: start_date.value,
                end_date: end_date.value
            })
        }
    );

    if (res.ok) {
        alert("Exam created successfully");
        window.location.href = "/exams/";
    } else {
        alert("Failed to create exam");
    }
};
</script>

{% endblock %}
